<!DOCTYPE html>
<html lang="fr">
<body style="background:#000; color:#0f0; font-family:monospace; padding:20px;">
    <h2>SCANNER DE VÉRITÉ GOOGLE</h2>
    <button onclick="tester()" style="padding:20px; width:100%; background:green; color:white; font-weight:bold;">CLIQUE ICI POUR VOIR L'ERREUR RÉELLE</button>
    <pre id="resultat" style="white-space:pre-wrap; margin-top:20px;">> En attente du test...</pre>

    <script>
        const KEY = localStorage.getItem('MAGIE_2026_KEY');

        async function tester() {
            const out = document.getElementById('resultat');
            out.innerText = "> Envoi de la requête...";
            
            try {
                // On teste le modèle PRO
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=${KEY}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({contents: [{parts: [{text: "Hello"}]}]})
                });

                const data = await res.json();
                
                if (res.ok) {
                    out.innerText = "✅ SUCCÈS ! L'IA répond parfaitement.\n" + JSON.stringify(data, null, 2);
                } else {
                    out.style.color = "red";
                    out.innerText = "❌ ERREUR DÉTECTÉE !\n\n" + 
                                    "Code : " + res.status + "\n" +
                                    "Message : " + data.error.message + "\n" +
                                    "Raison : " + data.error.status;
                }
            } catch (e) {
                out.innerText = "❌ CRASH RÉSEAU : " + e.message;
            }
        }
    </script>
</body>
</html>